<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="小米路由器mini刷PandoraBox"/>




  <meta name="keywords" content="router,network," />




  <link rel="alternate" href="/atom.xml" title="Kompass">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.1.x" />



<link rel="canonical" href="http://yoursite.com/2015/12/01/小米路由器mini 刷 PandoraBox/"/>


<meta name="description" content="1.准备工作
小米路由器mini
U盘一个（FAT32格式）
WinSCP
Xshell


2.刷入开发版本ROM从小米wifi官网下载小米路由器mini的开发版本。首先，请先准备一个U盘，并确保这个U盘的格式为FAT或FAT32.接下来，就是具体的操作流程：

在miwifi.com官网下载路由器对应的ROM包，并将其放在U盘的根目录下，命名为miwifi.bin
断开小米路由器mini的电源">
<meta property="og:type" content="article">
<meta property="og:title" content="小米路由器mini刷PandoraBox">
<meta property="og:url" content="http://yoursite.com/2015/12/01/小米路由器mini 刷 PandoraBox/index.html">
<meta property="og:site_name" content="Kompass">
<meta property="og:description" content="1.准备工作
小米路由器mini
U盘一个（FAT32格式）
WinSCP
Xshell


2.刷入开发版本ROM从小米wifi官网下载小米路由器mini的开发版本。首先，请先准备一个U盘，并确保这个U盘的格式为FAT或FAT32.接下来，就是具体的操作流程：

在miwifi.com官网下载路由器对应的ROM包，并将其放在U盘的根目录下，命名为miwifi.bin
断开小米路由器mini的电源">
<meta property="og:image" content="http://qingdao.icean.cc:11234/Imgbed/PandoraBox/4-1.jpg">
<meta property="og:image" content="http://qingdao.icean.cc:11234/Imgbed/PandoraBox/4-2.jpg">
<meta property="og:image" content="http://qingdao.icean.cc:11234/Imgbed/PandoraBox/5-1.jpg">
<meta property="og:image" content="http://qingdao.icean.cc:11234/Imgbed/PandoraBox/6-1.jpg">
<meta property="og:image" content="http://qingdao.icean.cc:11234/Imgbed/PandoraBox/8-1.jpg">
<meta property="og:updated_time" content="2017-01-29T07:25:20.244Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="小米路由器mini刷PandoraBox">
<meta name="twitter:description" content="1.准备工作
小米路由器mini
U盘一个（FAT32格式）
WinSCP
Xshell


2.刷入开发版本ROM从小米wifi官网下载小米路由器mini的开发版本。首先，请先准备一个U盘，并确保这个U盘的格式为FAT或FAT32.接下来，就是具体的操作流程：

在miwifi.com官网下载路由器对应的ROM包，并将其放在U盘的根目录下，命名为miwifi.bin
断开小米路由器mini的电源">
<meta name="twitter:image" content="http://qingdao.icean.cc:11234/Imgbed/PandoraBox/4-1.jpg">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.1.x" />



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />




  



    <title> 小米路由器mini刷PandoraBox · Kompass </title>
  </head>

  <body>
    <div class="container">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo"><img src="http://qingdao.icean.cc:11234/Imgbed/logo.png" height="58" width="58">  Kompass</a>
  
</div>

<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              主页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            
            
              标签
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            
            
              关于
            
          </a>
        </li>
      
      
    </ul>
  
</nav>

<div class="mobile-navbar">
  <div class="mobile-header">
    <div class="mobile-header-logo">
      <a href="/." class="logo">Kompass</a>
    </div>

    <div class="mobile-header-icon">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
  <nav class="mobile-menu">
    
      <a class="mobile-menu-item" href="/">
        
        
          主页
        
      </a>
    
      <a class="mobile-menu-item" href="/archives/">
        
        
          归档
        
      </a>
    
      <a class="mobile-menu-item" href="/tags">
        
        
          标签
        
      </a>
    
      <a class="mobile-menu-item" href="/about">
        
        
          关于
        
      </a>
    
  </nav>
</div>
      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          小米路由器mini刷PandoraBox
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          Dec 1, 2015
        </span>
      </div>
    </header>

    
      <div class="post-toc" id="post-toc">
        <h2 class="post-toc-title">Contents</h2>
        <div class="post-toc-content">
          <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-准备工作"><span class="toc-text">1.准备工作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-刷入开发版本ROM"><span class="toc-text">2.刷入开发版本ROM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-初始化路由器"><span class="toc-text">3.初始化路由器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-获取SSH权限"><span class="toc-text">4.获取SSH权限</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-刷入PandoraBox"><span class="toc-text">5.刷入PandoraBox</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-偏好设置"><span class="toc-text">6.偏好设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-IPv4-NAT"><span class="toc-text">7.IPv4 NAT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-IPv6-穿透"><span class="toc-text">8.IPv6 穿透</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#etc-config-network"><span class="toc-text">/etc/config/network</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#etc-config-dhcp"><span class="toc-text">/etc/config/dhcp</span></a></li></ol></li></ol>
        </div>
      </div>
    

    <div class="post-content">
      
        <h3 id="1-准备工作"><a href="#1-准备工作" class="headerlink" title="1.准备工作"></a>1.准备工作</h3><ul>
<li>小米路由器mini</li>
<li>U盘一个（FAT32格式）</li>
<li>WinSCP</li>
<li>Xshell</li>
</ul>
<hr>
<h3 id="2-刷入开发版本ROM"><a href="#2-刷入开发版本ROM" class="headerlink" title="2.刷入开发版本ROM"></a>2.刷入开发版本ROM</h3><p>从<a href="http://miwifi.com/miwifi_download.html" target="_blank" rel="external">小米wifi官网</a>下载小米路由器mini的开发版本。首先，请先准备一个U盘，并确保这个U盘的格式为FAT或FAT32.接下来，就是具体的操作流程：</p>
<ul>
<li>在miwifi.com官网下载路由器对应的ROM包，并将其放在U盘的根目录下，命名为miwifi.bin</li>
<li>断开小米路由器mini的电源，将U盘插入路由器的USB接口</li>
<li>按下reset按钮后重新接入电源，待指示灯变为黄色闪烁状态后松开reset键</li>
<li>等待5~8分钟，刷机完成之后系统会自动重启并进入正常的启动状态（指示灯由黄灯常亮变为蓝灯常亮），此时，说明刷机成功完成！</li>
</ul>
<blockquote>
<p>如果出现异常/失败/U盘无法读取状态，会进入红灯状态，建议重试或更换U盘再试。</p>
</blockquote>
<hr>
<h3 id="3-初始化路由器"><a href="#3-初始化路由器" class="headerlink" title="3.初始化路由器"></a>3.初始化路由器</h3><p>刷入开发版本的ROM，最好初始化一遍路由器，不初始化在之后的刷如PandoraBox可能有些问题。</p>
<hr>
<h3 id="4-获取SSH权限"><a href="#4-获取SSH权限" class="headerlink" title="4.获取SSH权限"></a>4.获取SSH权限</h3><p>要获取SSH权限，首先要和小米账户进行绑定，具体如何绑定请自行Google或者Baidu。<br>绑定成功后，会在网页上显示root密码以及下载SSH工具包的链接。如图4-1，图4-2所示。</p>
<p><span style="color:purple">图4-1</span><br><img src="http://qingdao.icean.cc:11234/Imgbed/PandoraBox/4-1.jpg" alt=""></p>
<p><span style="color:purple">图4-2</span><br><img src="http://qingdao.icean.cc:11234/Imgbed/PandoraBox/4-2.jpg" alt=""></p>
<p>刷入SSH工具包步骤如下。</p>
<ul>
<li>将下载的工具包bin文件复制到U盘（FAT/FAT32格式）的根目录下，保证文件名为miwifi_ssh.bin；</li>
<li>断开小米路由器的电源，将U盘插入USB接口；</li>
<li>按住reset按钮之后重新接入电源，指示灯变为黄色闪烁状态即可松开reset键；</li>
<li>等待3-5秒后安装完成之后，小米路由器会自动重启，之后就可以尽情折腾啦。</li>
</ul>
<hr>
<h3 id="5-刷入PandoraBox"><a href="#5-刷入PandoraBox" class="headerlink" title="5.刷入PandoraBox"></a>5.刷入PandoraBox</h3><p>使用WinSCP将PandoraBox的镜像导入到小米路由器的/tmp目录下。PandoraBox下载地址请点击<a href="http://downloads.openwrt.org.cn/PandoraBox/" target="_blank" rel="external">这里</a>，或者<a href="http://pan.baidu.com/s/1sj6AI9f" target="_blank" rel="external">这里</a>。WinSCP的界面如图5-1所示。</p>
<p><span style="color:purple">图5-1</span><br><img src="http://qingdao.icean.cc:11234/Imgbed/PandoraBox/5-1.jpg" alt=""></p>
<p>此时，可以通过xshell SSH登录小米路由器mini了，路由器的IP缺省为192.168.1.1，账户为root，密码为在小米路由器官网上给出的。执行如下命令</p>
<pre><code>mtd -r write /tmp/PandoraBox-ralink-mt7620-xiaomi-mini-squashfs-sysupgrade-r512-20150309 OS1
</code></pre><p>这样开始了刷机，几分钟过后刷机成功，可在PC的wifi列表中找到PandoraBox的SSID。连接其中一个成功之后，可以登录192.168.1.1进行管理了，也可以通过xshell ssh登录，地址也为192.168.1.1。以上两种登录方式的账户都是root，缺省密码为admin。</p>
<hr>
<h3 id="6-偏好设置"><a href="#6-偏好设置" class="headerlink" title="6.偏好设置"></a>6.偏好设置</h3><p>在进行开始设置之前，极力推荐备份下/etc目录下的所有文件，如图6-1所示。在路由器命令行下，执行如下命令：</p>
<pre><code>tar cvpzf etc_back.tgz /etc
</code></pre><p><span style="color:purple">图6-1</span><br><img src="http://qingdao.icean.cc:11234/Imgbed/PandoraBox/6-1.jpg" alt=""></p>
<p>备份完毕，将备份下载到本地保存。</p>
<p>进行偏好设置，例如无线的SSID，无线密码，管理密码等等。设置完毕之后，可以在PandoraBox网页端进行备份，同时推荐在命令行下进行备份/etc目录。备份方法如上。</p>
<hr>
<h3 id="7-IPv4-NAT"><a href="#7-IPv4-NAT" class="headerlink" title="7.IPv4 NAT"></a>7.IPv4 NAT</h3><p>这个缺省已经设置好了，无需进行任何修改。</p>
<hr>
<h3 id="8-IPv6-穿透"><a href="#8-IPv6-穿透" class="headerlink" title="8.IPv6 穿透"></a>8.IPv6 穿透</h3><p>这是我本次刷机最大的目的，实现了IPv4的NAT方式，然后还可以获取原生的IPv6。在最新版本的PandoraBox中，已经集成了实现IPv6穿透的服务或者软件，所以只需要修改一些配置文件即可。其中主要修改的就是/etc/config/network和/etc/config/dhcp文件，修改后的文件如下所示。</p>
<hr>
<h4 id="etc-config-network"><a href="#etc-config-network" class="headerlink" title="/etc/config/network"></a>/etc/config/network</h4><pre><code>config interface &apos;loopback&apos;
    option ifname &apos;lo&apos;
    option proto &apos;static&apos;
    option ipaddr &apos;127.0.0.1&apos;
    option netmask &apos;255.0.0.0&apos;

config globals &apos;globals&apos;
    #option ula_prefix &apos;auto&apos;

config interface &apos;lan&apos;
    option ifname &apos;eth0.1&apos;
    option force_link &apos;1&apos;
    option type &apos;bridge&apos;
    option proto &apos;static&apos;
    option ipaddr &apos;192.168.1.1&apos;
    option netmask &apos;255.255.255.0&apos;
    option ip6assign &apos;64&apos;
    option macaddr &apos;f0:b4:29:5a:ff:f6&apos;

config interface &apos;wan&apos;
    option ipv6 &apos;1&apos;
    option ifname &apos;eth0.2&apos;
    option proto &apos;dhcp&apos;
    option macaddr &apos;f0:b4:29:5a:ff:f7&apos;

config interface &apos;wan6&apos;
    option ifname &apos;@wan&apos;
    #option ifname &apos;eth0.2&apos;
    option proto &apos;dhcpv6&apos;

config switch
    option name &apos;mt762x&apos;
    option reset &apos;1&apos;
    option enable_vlan &apos;1&apos;

config switch_vlan
    option device &apos;mt762x&apos;
    option vlan &apos;1&apos;
    option ports &apos;0 1 2 3 5 6t 7t&apos;

config switch_vlan
    option device &apos;mt762x&apos;
    option vlan &apos;2&apos;
    option ports &apos;4 6t 7t&apos;
</code></pre><h4 id="etc-config-dhcp"><a href="#etc-config-dhcp" class="headerlink" title="/etc/config/dhcp"></a>/etc/config/dhcp</h4><pre><code>config dnsmasq
    option domainneeded &apos;1&apos;
    option boguspriv &apos;1&apos;
    option filterwin2k &apos;0&apos;
    option localise_queries &apos;1&apos;
    option rebind_protection &apos;1&apos;
    option rebind_localhost &apos;1&apos;
    option local &apos;/lan/&apos;
    option domain &apos;lan&apos;
    option expandhosts &apos;1&apos;
    option nonegcache &apos;0&apos;
    option authoritative &apos;1&apos;
    option readethers &apos;1&apos;
    option leasefile &apos;/tmp/dhcp.leases&apos;
    option resolvfile &apos;/tmp/resolv.conf.auto&apos;

config dhcp &apos;lan&apos;
    option interface &apos;lan&apos;
    option start &apos;100&apos;
    option limit &apos;150&apos;
    option leasetime &apos;12h&apos;
    #option dhcpv6 &apos;server&apos;
    option ra &apos;relay&apos;
    option ndp &apos;relay&apos;

config dhcp &apos;wan6&apos;
    option ra &apos;relay&apos;
    option ndp &apos;relay&apos;
    option master &apos;1&apos;

#config dhcp &apos;wan&apos;
    #option interface &apos;wan&apos;
    #option ignore &apos;1&apos;

config odhcpd &apos;odhcpd&apos;
    option maindhcp &apos;0&apos;
    option leasefile &apos;/tmp/hosts/odhcpd&apos;
    option leasetrigger &apos;/usr/sbin/odhcpd-update&apos;
</code></pre><p>设置好上面的两个文件之后，重启相关服务</p>
<pre><code>/etc/init.d/odhcpd restart
/etc/init.d/network restart
</code></pre><p>这样在浏览器上就可以获取IPv4 NAT私有地址以及原生的IPv6地址了。如图8-1所示。</p>
<p><span style="color:purple">图8-1</span><br><img src="http://qingdao.icean.cc:11234/Imgbed/PandoraBox/8-1.jpg" alt=""></p>
<blockquote>
<p>若IPv6能获取地址但是不能上网，请重启odhcpd服务。</p>
</blockquote>

      
    </div>

    
      <footer class="post-footer">
        <div class="post-tags">
          
            <a href="/tags/router/">router</a>
          
            <a href="/tags/network/">network</a>
          
        </div>

        
  <nav class="post-nav">
    
      <a class="prev" href="/2015/12/23/Wireshark TCP抓包总结/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">Wireshark TCP抓包总结</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2015/11/04/Winows node ppt安装/">
        <span class="next-text nav-default">Windows下nodeppt安装</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    
  </article>


          </div>
          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2015/12/01/小米路由器mini 刷 PandoraBox/"
           data-title="小米路由器mini刷PandoraBox" data-url="http://yoursite.com/2015/12/01/小米路由器mini 刷 PandoraBox/">
      </div>
    
  </div>

        </div>  
      </main>

      <footer id="footer" class="footer">
  <div class="social-links">
    
      
        
          <a href="mailto:mailto:iceanness@gmail.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
        
          <a href="https://twitter.com/Iceanian" class="iconfont icon-twitter" title="twitter"></a>
        
      
    
      
    
      
        
          <a href="https://github.com/icean" class="iconfont icon-github" title="github"></a>
        
      
    
      
        
          <a href="http://weibo.com/1509230644" class="iconfont icon-weibo" title="weibo"></a>
        
      
    
      
    
    
    
  </div>


<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://hexo.io/">Hexo</a>
  </span>
  
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2015 - 
    
    2017

    <span class="heart">
      <! --<i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Icean L</span>
  </span>
</div>
      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"kompass"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>



    
  





  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  

    <script type="text/javascript" src="/js/src/even.js?v=2.1.x"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.1.x"></script>

  </body>
</html>