<!DOCTYPE html>
<html lang="">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="AWK 学习"/>




  <meta name="keywords" content="linux,shell," />




  <link rel="alternate" href="/atom.xml" title="Kompass">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.1.x" />



<link rel="canonical" href="http://yoursite.com/2017/01/16/AWK学习/"/>


<meta name="description" content="AWK 学习">
<meta property="og:type" content="article">
<meta property="og:title" content="AWK 学习">
<meta property="og:url" content="http://yoursite.com/2017/01/16/AWK学习/index.html">
<meta property="og:site_name" content="Kompass">
<meta property="og:description" content="AWK 学习">
<meta property="og:updated_time" content="2017-02-13T04:40:20.421Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="AWK 学习">
<meta name="twitter:description" content="AWK 学习">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.1.x" />







<script type="text/javascript">
  var themeConfig = {
    search: {
      enable: ,
      path: "/search.xml",
    },
    navbar: {
      enable: 
    },
    fancybox: {
      enable: 
    },
    toc: {
      enable: 
    },
  };
</script>



  



    <title> AWK 学习 · Kompass </title>
  </head>

  <body>
    <div class="container">
      <header id="header" class="header"><div class="logo-wrapper">
   <a href="/." class="logo"><img src="http://qingdao.icean.cc:11234/Imgbed/logo.png" height="58" width="58">  Kompass</a>
</div>

<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              主页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives">
            
            
              归档
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            
            
              分类
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            
            
              标签
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            
            
              关于
            
          </a>
        </li>
      
      
    </ul>
  
</nav>

<div class="mobile-navbar">
  <div class="mobile-header">
    <div class="mobile-header-logo">
      <a href="/." class="logo">Kompass</a>
    </div>

    <div class="mobile-header-icon">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
  <nav class="mobile-menu">
    
      <a class="mobile-menu-item" href="/">
        
        
          主页
        
      </a>
    
      <a class="mobile-menu-item" href="/archives">
        
        
          归档
        
      </a>
    
      <a class="mobile-menu-item" href="/categories">
        
        
          分类
        
      </a>
    
      <a class="mobile-menu-item" href="/tags">
        
        
          标签
        
      </a>
    
      <a class="mobile-menu-item" href="/about">
        
        
          关于
        
      </a>
    
  </nav>
</div>
      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          AWK 学习
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
          2017年1月16日
        </span>
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-示例文件"><span class="toc-text">1. 示例文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-操作"><span class="toc-text">2. 操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#在原第一列前处添加新的一列"><span class="toc-text">在原第一列前处添加新的一列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#在原最后一列后添加一列"><span class="toc-text">在原最后一列后添加一列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#在原最后一列后添加两列"><span class="toc-text">在原最后一列后添加两列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#在原倒数第二列前添加一列"><span class="toc-text">在原倒数第二列前添加一列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#更新一列的内容"><span class="toc-text">更新一列的内容</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#大小写转化"><span class="toc-text">大小写转化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#字符串截取"><span class="toc-text">字符串截取</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#清空某一列"><span class="toc-text">清空某一列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#删除某一列"><span class="toc-text">删除某一列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#修改分隔符"><span class="toc-text">修改分隔符</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-拓展"><span class="toc-text">3. 拓展</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-例子"><span class="toc-text">4. 例子</span></a></li></ol>
    </div>
  </div>


    <div class="post-content">
      
        <h3 id="1-示例文件"><a href="#1-示例文件" class="headerlink" title="1. 示例文件"></a>1. 示例文件</h3><p>示例文件内容如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ cat file</div><div class="line">Unix,10,A</div><div class="line">Linux,30,B</div><div class="line">Solaris,40,C</div><div class="line">Fedora,20,D</div><div class="line">Ubuntu,50,E</div></pre></td></tr></table></figure>
<hr>
<h3 id="2-操作"><a href="#2-操作" class="headerlink" title="2. 操作"></a>2. 操作</h3><h4 id="在原第一列前处添加新的一列"><a href="#在原第一列前处添加新的一列" class="headerlink" title="在原第一列前处添加新的一列"></a>在原第一列前处添加新的一列</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ awk -F, <span class="string">'&#123;$1=++i FS $1;&#125;1'</span> OFS=, file</div><div class="line">1,Unix,10,A</div><div class="line">2,Linux,30,B</div><div class="line">3,Solaris,40,C</div><div class="line">4,Fedora,20,D</div><div class="line">5,Ubuntu,50,E</div></pre></td></tr></table></figure>
<p><strong>F</strong>代表分隔符，使用的分割符为 <strong>,</strong> ，将<strong>\$1</strong>替换为<strong>++i</strong> 的结果 加<strong>FS</strong>（分隔符）加原<strong>\$1</strong>，可以理解为<code>\$1=(++i) + FS + $1</code>。后面的<strong>1</strong>代表打印全部。可以通过下面方式设置<strong>i</strong>的初始值。<strong>OFS</strong>代表输出的分隔符，也为 <strong>,</strong> </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ awk -F,  -v=10 <span class="string">'&#123;$1=++i FS $1;&#125;1'</span> OFS=, file</div><div class="line">$ awk -F,   <span class="string">'&#123;$1=++i FS $1;&#125;1'</span> i=10 OFS=, file</div></pre></td></tr></table></figure>
<p>如果不只是添加数字，还要添加个前缀，如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ awk -F, <span class="string">'&#123;$1="VM"++i FS $1;&#125;1'</span> OFS=, file</div></pre></td></tr></table></figure>
<h4 id="在原最后一列后添加一列"><a href="#在原最后一列后添加一列" class="headerlink" title="在原最后一列后添加一列"></a>在原最后一列后添加一列</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ awk -F, <span class="string">'&#123;$(NF+1)=++i;&#125;1'</span> OFS=, file</div><div class="line">Unix,10,A,1</div><div class="line">Linux,30,B,2</div><div class="line">Solaris,40,C,3</div><div class="line">Fedora,20,D,4</div><div class="line">Ubuntu,50,E,5</div></pre></td></tr></table></figure>
<p><strong>NF</strong>代表一行的列数，<strong>NF+1</strong>列为循环产生的数字，然后打印出来</p>
<h4 id="在原最后一列后添加两列"><a href="#在原最后一列后添加两列" class="headerlink" title="在原最后一列后添加两列"></a>在原最后一列后添加两列</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ awk -F, <span class="string">'&#123;$(NF+1)=++i FS "X";&#125;1'</span> OFS=, file</div><div class="line">Unix,10,A,1,X</div><div class="line">Linux,30,B,2,X</div><div class="line">Solaris,40,C,3,X</div><div class="line">Fedora,20,D,4,X</div><div class="line">Ubuntu,50,E,5,X</div></pre></td></tr></table></figure>
<h4 id="在原倒数第二列前添加一列"><a href="#在原倒数第二列前添加一列" class="headerlink" title="在原倒数第二列前添加一列"></a>在原倒数第二列前添加一列</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ awk -F, <span class="string">'&#123;$(NF-1)=++i FS $(NF-1);&#125;1'</span> OFS=, file</div><div class="line">Unix,1,10,A</div><div class="line">Linux,2,30,B</div><div class="line">Solaris,3,40,C</div><div class="line">Fedora,4,20,D</div><div class="line">Ubuntu,5,50,E</div></pre></td></tr></table></figure>
<p><strong>NF-1</strong>指倒数第二列</p>
<h4 id="更新一列的内容"><a href="#更新一列的内容" class="headerlink" title="更新一列的内容"></a>更新一列的内容</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ awk -F, <span class="string">'&#123;$2+=10;&#125;1'</span> OFS=, file</div><div class="line">Unix,20,A</div><div class="line">Linux,40,B</div><div class="line">Solaris,50,C</div><div class="line">Fedora,30,D</div><div class="line">Ubuntu,60,E</div></pre></td></tr></table></figure>
<h4 id="大小写转化"><a href="#大小写转化" class="headerlink" title="大小写转化"></a>大小写转化</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ awk -F, <span class="string">'&#123;$1=toupper($1)&#125;1'</span> OFS=, file</div><div class="line">UNIX,10,A</div><div class="line">LINUX,30,B</div><div class="line">SOLARIS,40,C</div><div class="line">FEDORA,20,D</div><div class="line">UBUNTU,50,E</div></pre></td></tr></table></figure>
<h4 id="字符串截取"><a href="#字符串截取" class="headerlink" title="字符串截取"></a>字符串截取</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ awk -F, <span class="string">'&#123;$1=substr($1,0,3)&#125;1'</span> OFS=, file</div><div class="line">Uni,10,A</div><div class="line">L<span class="keyword">in</span>,30,B</div><div class="line">Sol,40,C</div><div class="line">Fed,20,D</div><div class="line">Ubu,50,E</div></pre></td></tr></table></figure>
<h4 id="清空某一列"><a href="#清空某一列" class="headerlink" title="清空某一列"></a>清空某一列</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ awk -F, <span class="string">'&#123;$2="";&#125;1'</span> OFS=, file</div><div class="line">Unix,,A</div><div class="line">Linux,,B</div><div class="line">Solaris,,C</div><div class="line">Fedora,,D</div><div class="line">Ubuntu,,E</div></pre></td></tr></table></figure>
<h4 id="删除某一列"><a href="#删除某一列" class="headerlink" title="删除某一列"></a>删除某一列</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ awk -F, <span class="string">'&#123;for(i=1;i&lt;=NF;i++) if(i!=x) f=f?f FS $i:$i; print f; f=""&#125;'</span> x=2 file</div><div class="line">Unix,A</div><div class="line">Linux,B</div><div class="line">Solaris,C</div><div class="line">Fedora,D</div><div class="line">Ubuntu,E</div></pre></td></tr></table></figure>
<p><strong>for(i=1;i&lt;=NF;i++)</strong>处理每一行的每一列， <strong>if(i!=x)</strong>判断当前列号是否要删除，如果要删除的，不执行下面的步骤。 <strong>f=f?f FS \$i:\$i</strong>，如果f没被赋值，则是<strong>$i</strong>，如果已经赋值了，则为<strong>f FS \$i</strong></p>
<h4 id="修改分隔符"><a href="#修改分隔符" class="headerlink" title="修改分隔符"></a>修改分隔符</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$ awk -F, <span class="string">'&#123;$2=$2":"$x; for(i=1;i&lt;=NF;i++) if(i!=x) f=f?f FS $i:$i; print f;f=""&#125;'</span> x=3 file</div><div class="line">Unix,10:A</div><div class="line">Linux,30:B</div><div class="line">Solaris,40:C</div><div class="line">Fedora,20:D</div><div class="line">Ubuntu,50:E</div></pre></td></tr></table></figure>
<hr>
<h3 id="3-拓展"><a href="#3-拓展" class="headerlink" title="3. 拓展"></a>3. 拓展</h3><ul>
<li>head和tail如果选择多个范围</li>
</ul>
<hr>
<h3 id="4-例子"><a href="#4-例子" class="headerlink" title="4. 例子"></a>4. 例子</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">awk  <span class="string">'&#123;$(NF+1)="z52-vm"++i; $(NF+1)="130.5.70."++j;print&#125;'</span> j=131 floating_ip_disassociate.sh</div></pre></td></tr></table></figure>

      
    </div>

    
      
      



      
      
  <div class="post-reward">
    <input type="checkbox" name="reward" id="reward" hidden />
    <label class="reward-button" for="reward">赞赏支持</label>
    <div class="qr-code">
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/image/reward/wechat.jpg" title="wechat">
        </label>
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/image/reward/alipay.jpg" title="alipay">
        </label>
      
    </div>
  </div>

    

    
      <footer class="post-footer">
        <div class="post-tags">
          
            <a href="/tags/linux/">linux</a>
          
            <a href="/tags/shell/">shell</a>
          
        </div>

        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2017/01/18/CentOS 6.x ocserv安装/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">CentOS 6.x ocserv 安装</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/2017/01/16/Linux重定向/">
        <span class="next-text nav-default">Linux Shell 标准输入、输出和错误重定向</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

      </footer>
    
  </article>


          </div>
          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2017/01/16/AWK学习/"
           data-title="AWK 学习" data-url="http://yoursite.com/2017/01/16/AWK学习/">
      </div>
    
  </div>

        </div>  
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:mailto:iceanness@gmail.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
        
          <a href="https://twitter.com/Iceanian" class="iconfont icon-twitter" title="twitter"></a>
        
      
    
      
    
      
        
          <a href="https://github.com/icean" class="iconfont icon-github" title="github"></a>
        
      
    
      
        
          <a href="http://weibo.com/1509230644" class="iconfont icon-weibo" title="weibo"></a>
        
      
    
      
    
    
    
  </div>


<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://hexo.io/">Hexo</a> 强力驱动
  </span>
  
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    
    &copy; 
     
      2015 - 
    
    2017

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Icean L</span>
  </span>
</div>
      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"kompass"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>



    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  

    <script type="text/javascript" src="/js/src/even.js?v=2.1.x"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=2.1.x"></script>

  </body>
</html>